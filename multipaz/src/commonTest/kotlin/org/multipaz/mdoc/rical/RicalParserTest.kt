package org.multipaz.mdoc.rical

import kotlinx.coroutines.test.runTest
import org.multipaz.crypto.X509Cert
import org.multipaz.crypto.X509CertChain
import org.multipaz.util.fromBase64
import kotlin.test.Test
import kotlin.test.assertEquals
import kotlin.test.assertNull
import kotlin.test.assertTrue

class RicalParserTest {
    companion object {

        private val RICAL_BASE64_ISO_SC17WG10_TEST_EVENT_WELLINGTON_NZ_NOV_2025 =
            "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"
        private val RICAL_SIGNER_CERT_PEM_ISO_SC17WG10_TEST_EVENT_WELLINGTON_NZ_NOV_2025 =
            """
-----BEGIN CERTIFICATE-----
MIICvDCCAmKgAwIBAgIQICEiIyQlJicoKSorLC0uLzAKBggqhkjOPQQDAjCBiTEg
MB4GA1UEAxMXTlpUQSBSaWNhbCBUZXN0IFJvb3QgQ0ExCzAJBgNVBAYTAk5aMQ0w
CwYDVQQKEwROWlRBMR4wHAYDVQQLExVDZXJ0aWZpY2F0ZSBBdXRob3JpdHkxKTAn
BgNVBAUTIDIwMjEyMjIzMjQyNTI2MjcyODI5MkEyQjJDMkQyRTJGMB4XDTI1MTEw
MTAwMDAwMFoXDTI3MTEwMTAwMDAwMFowgYkxIDAeBgNVBAMTF05aVEEgUmljYWwg
VGVzdCBSb290IENBMQswCQYDVQQGEwJOWjENMAsGA1UEChMETlpUQTEeMBwGA1UE
CxMVQ2VydGlmaWNhdGUgQXV0aG9yaXR5MSkwJwYDVQQFEyAyMDIxMjIyMzI0MjUy
NjI3MjgyOTJBMkIyQzJEMkUyRjBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABBwy
sXrof7iodccEukGJweja+Sj09KtkrbwRaymxhhoxiaAxsjlhlH7VhHEUJg/Hb2Qq
UUVvUhjB0g9zWdPkLKOjgakwgaYwHQYDVR0OBBYEFJ59xN3cStLSmzL1yMUrZBva
Fmh2MA4GA1UdDwEB/wQEAwIBBjAhBgNVHRIEGjAYgRZyaWNhbEBuenRhLm1kb2Mu
b25saW5lMA8GA1UdEwEB/wQFMAMBAf8wQQYDVR0fBDowODA2oDSgMoYwaHR0cHM6
Ly9uenRhLm1kb2Mub25saW5lL05aVEFSaWNhbFRlc3RSb290Q0EuY3JsMAoGCCqG
SM49BAMCA0gAMEUCIQCFUVloWpR9Y+kfI/h4uqklwP3azege3At6xh8M5GOecAIg
DK+pCMrWxNz63+qbAFu4ant+3Vvr2A0CjUSj2wjgnOg=
-----END CERTIFICATE-----
            """.trimIndent()
    }

    @Test
    fun testIsoSc17Wg10WellingtonRical() = runTest {
        val signedRical = SignedRical.parse(RICAL_BASE64_ISO_SC17WG10_TEST_EVENT_WELLINGTON_NZ_NOV_2025.fromBase64())

        // Check RICAL is signed by the expected key. Note
        //
        //   The RICAL root certificate shall not be included in the x5chain header,
        //   but additional intermediate certificates may be included if
        //   needed to complete the chain to the trust anchor.
        //
        val certChain = signedRical.ricalProviderCertificateChain
        assertEquals(1, certChain.certificates.size)
        val rootCert = X509Cert.fromPem(RICAL_SIGNER_CERT_PEM_ISO_SC17WG10_TEST_EVENT_WELLINGTON_NZ_NOV_2025)
        val certChainWithRoot = X509CertChain(listOf(certChain.certificates.first(), rootCert))
        assertTrue(certChainWithRoot.validate())

        // Check RICAL data
        val r = signedRical.rical
        assertEquals("NZTA", r.provider)
        assertEquals("1.0", r.version)
        assertEquals("2025-11-13T10:09:13.652142500Z", r.date.toString())
        assertEquals(null, r.nextUpdate)
        assertEquals(null, r.id)
        assertEquals(16, r.certificateInfos.size)

        // Manually inspect the first certificate...
        val ci = r.certificateInfos.first()
        assertEquals(
            X509Cert.fromPem(
                """
-----BEGIN CERTIFICATE-----
MIICnDCCAkKgAwIBAgITVFYPNeh2FRvRxPdLgD+liuJlzzAKBggqhkjOPQQDAjBW
MREwDwYDVQQIEwhDb2xvcmFkbzELMAkGA1UEBhMCVVMxGTAXBgNVBAoTEEZBU1Qg
RW50ZXJwcmlzZXMxGTAXBgNVBAMTEEZBU1QgRW50ZXJwcmlzZXMwHhcNMjUxMDIy
MDYwMDAwWhcNMzUxMDIyMDYwMDAwWjBWMREwDwYDVQQIEwhDb2xvcmFkbzELMAkG
A1UEBhMCVVMxGTAXBgNVBAoTEEZBU1QgRW50ZXJwcmlzZXMxGTAXBgNVBAMTEEZB
U1QgRW50ZXJwcmlzZXMwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARCggh3CJcv
eiI+gp7TNgdTdxqRWITvBRuAB7un1fPzaCjlBYRgRwHB0iRScuWT6Rn9DdXTGupT
/TAKqf4UlwLLo4HuMIHrMA4GA1UdDwEB/wQEAwIHgDAPBgNVHRMBAf8EBTADAQH/
MB0GA1UdDgQWBBQiUK6QqibhNVkIXjWGuEEkyGHZSTASBgNVHSUECzAJBgcogYxd
BQEGMIGCBgNVHR8EezB5MHegdaBzhnFodHRwczovL2Vudmlyb25tZW50cy5nZW50
YXguY29tL1AxRC9XZWJTZXJ2aWNlcy9Nb2JpbGVDcmVkZW50aWFsL1Jldm9jYXRp
b25zL2QxZmNmN2Y1NGNkOTQ4YzhiNjRjMTA1YmQyOTJjNzk5LmNybDAQBgkrBgEE
AYPFIQEEA1AxRDAKBggqhkjOPQQDAgNIADBFAiEA/LhjpoyqLoIyJn/Q8qmb+lo/
WgP97pb4HjvveikPDRECIDkQB2rDBcFJJb4Qv9ALFvXYAH4zm4mcjYMP0RkUCzCB
-----END CERTIFICATE-----
            """.trimIndent()
            ),
        ci.certificate
        )
        assertEquals(
            "CN=FAST Enterprises,O=FAST Enterprises,C=US,ST=Colorado",
            ci.certificate.subject.name
        )
        assertEquals(
            "CN=FAST Enterprises,O=FAST Enterprises,C=US,ST=Colorado",
            ci.certificate.issuer.name
        )
        assertEquals(
            null,
            ci.type
        )
    }
}